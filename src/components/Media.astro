---
interface Props {
  class?: string
  src?: string
  alt?: string
  ratio?: '1:1' | '4:3' | '16:9' | '21:9' | 'auto'
  loading?: 'lazy' | 'eager'
  decoding?: 'async' | 'sync' | 'auto'
  fetchpriority?: 'high' | 'low' | 'auto'
}

const {
  class: className,
  src = 'https://fakeimg.pl/640x360',
  alt = '',
  ratio = 'auto',
  loading = 'lazy',
  decoding = 'async',
  fetchpriority = 'auto',
} = Astro.props

const aspectRatios = {
  '1:1': '1',
  '4:3': '4/3',
  '16:9': '16/9',
  '21:9': '21/9',
  auto: 'auto',
}
---

<div class:list={['media-wrapper', className]} data-ratio={ratio}>
  <img
    src={src}
    alt={alt}
    loading={loading}
    decoding={decoding}
    fetchpriority={fetchpriority}
    style={ratio !== 'auto' ? `aspect-ratio: ${aspectRatios[ratio]};` : ''}
  />
</div>

<style>
  :where(.media-wrapper) {
    inline-size: 100%;
  }

  :where(img) {
    inline-size: 100%;
    block-size: auto;
    object-fit: cover;
  }
</style>
